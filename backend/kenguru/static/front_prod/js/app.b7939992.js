(function(){"use strict";var t={2993:function(t,e,r){var a=r(6369),n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"app"}},[r("v-app",{staticClass:"w-100"},[r("v-main",[r("home-view",{on:{showAlert:function(e){return t.showAlert(e)}}}),r("v-snackbar",{attrs:{color:"white"},scopedSlots:t._u([{key:"action",fn:function(e){var a=e.attrs;return[r("v-btn",t._b({attrs:{color:"orange accent-2",tile:""},on:{click:function(e){t.snackbar=!1}}},"v-btn",a,!1),[t._v(" Ок ")])]}}]),model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[r("span",{staticClass:"text-dark"},[t._v(t._s(t.snackbarText))])])],1)],1)],1)},o=[],s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"w-100 h-100 px-3 pt-2 pb-5  d-flex flex-column  bg--warning align-self-center justify-center"},[r("div",{staticClass:"row "},[r("div",{staticClass:"col-12 col-sm-8 col-md-6 col-lg-5 col-xl-3 m-auto"},[r("div",{staticClass:"card shadow-lg p-3 text-center"},[t._m(0),t._m(1),"ok"===t.isLoad?r("form",{staticClass:"card-body text-center"},[r("div",{staticClass:"mb-5"},[r("v-autocomplete",{attrs:{label:"Маркет*","item-text":"name","no-data-text":"Маркет не найден","item-value":"id",messages:"Был: "+t.lastMarket,items:t.marketsList},model:{value:t.market,callback:function(e){t.market=e},expression:"market"}})],1),r("div",{staticClass:"mb-5"}),r("div",{staticClass:"mb-5 mt-5"},[r("small",[t._v("Синхронизация: "+t._s(t.dateUpdate))])]),r("v-btn",{staticClass:"px-5",attrs:{color:"warning",dark:"",disabled:!t.market},on:{click:t.save}},[t._v("Синхронизировать ")])],1):t._e(),"error"===t.isLoad?r("div",{staticClass:"card-body text-center"},[r("div",{staticClass:"mb-3"},[t._v(t._s(t.errorText))]),r("v-btn",{staticClass:"px-5",attrs:{color:"warning",dark:""},on:{click:t.refresh}},[t._v("Обновить ")])],1):t._e(),""===t.isLoad?r("div",{staticClass:"card-body text-center"},[r("p",[t._v("Загрузка...")])]):t._e()])])])])},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"text-center"},[a("img",{staticClass:"logo mb-3",attrs:{src:r(1637),alt:""}})])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("h3",[r("b",[t._v("КЕНГУРУ МАРКЕТ")])])}];let c="http://127.0.0.1:8001",l="http://crm.ikenguru.ru";var u={marketToken:"!!!ken!!!guru!!",urls:{autocomplete:`${l}/api1/market/autocomplete`,localSetting:`${c}/get_local_setting`}},d={getCookie(t){const e=`; ${document.cookie}`,r=e.split(`; ${t}=`);if(2===r.length)return r.pop().split(";").shift()},setCookie(t,e,r={}){r={path:"/",...r},r.expires instanceof Date&&(r.expires=r.expires.toUTCString());let a=encodeURIComponent(t)+"="+encodeURIComponent(e);for(let n in r){a+="; "+n;let t=r[n];!0!==t&&(a+="="+t)}document.cookie=a}},f={name:"HomeView",components:{},data(){return{market:"",audio:"",lastMarket:"н/д",errorText:"",dateUpdate:"н/д",marketsList:[],audioList:[],isLoad:""}},created:async function(){this.refresh()},methods:{async getMarket(){const t=this;t.marketsList=[];try{const e=u.urls.autocomplete,r=await fetch(e,{method:"POST",body:JSON.stringify({token:u.marketToken}),headers:{"Content-Type":"application/json","X-CSRFToken":d.getCookie("csrftoken")}});200===r.status?t.marketsList=await r.json():(t.isLoad="error",this.$emit("showAlert","Ошибка  при обращение к CRM. Подробности в консоли"),t.errorText="Ошибка при обращение к CRM. Подробности в консоли")}catch(e){t.isLoad="error",this.$emit("showAlert","Ошибка при обращение к CRM. Подробности в консоли"),t.errorText="Ошибка при обращение к CRM. Подробности в консоли"}},async getLocalSetting(){const t=this;try{const e=u.urls.localSetting,r=await fetch(e,{method:"GET",headers:{"Content-Type":"application/json","X-CSRFToken":d.getCookie("csrftoken")}});if(200===r.status){const e=await r.json();t.market=e.setting.marketId,t.lastMarket=e.setting.marketName,t.dateUpdate=e.setting.dateUpdate,t.isLoad="ok"}else t.isLoad="error",this.$emit("showAlert","Ошибка  при обращение к настройкам клиента. Подробности в консоли"),t.errorText="Ошибка при обращение к настройкам клиента. Подробности в консоли"}catch(e){t.isLoad="error",this.$emit("showAlert","Ошибка  при обращение к настройкам клиента. Подробности в консоли"),t.errorText="Ошибка при обращение к настройкам клиента. Подробности в консоли"}},async refresh(){this.isLoad="",await this.getMarket(),this.marketsList&&await this.getLocalSetting()},async save(){try{const t=this.marketsList.findIndex((t=>t.id===this.market)),e=this.marketsList[t].name;this.isLoad="";const r=u.urls.localSetting,a=await fetch(r,{method:"POST",body:JSON.stringify({marketId:this.market,marketName:e,audio:this.audio}),headers:{"Content-Type":"application/json","X-CSRFToken":d.getCookie("csrftoken")}});200===a.status?(this.$emit("showAlert","Синхронизация с CRM прошла"),this.refresh()):this.$emit("showAlert","Ошибка при синхронизации. Подробности в консоли")}catch(t){this.$emit("showAlert","Ошибка при синхронизации. Подробности в консоли")}this.isLoad="ok"}}},m=f,h=r(3736),p=(0,h.Z)(m,s,i,!1,null,"77efa8ca",null),k=p.exports,v={components:{HomeView:k},methods:{showAlert(t){this.snackbar=!0,this.snackbarText=t}},data(){return{snackbar:!1,snackbarText:""}}},g=v,b=(0,h.Z)(g,n,o,!1,null,null,null),C=b.exports,w=r(707),x=r.n(w);r(8556);a["default"].use(x());const y={};var _=new(x())(y),T=(r(8937),r(8510)),L=r.n(T);a["default"].config.productionTip=!1,new a["default"]({VueCookie:L(),vuetify:_,render:t=>t(C)}).$mount("#app")},1637:function(t,e,r){t.exports=r.p+"static/front_prod/img/logo2.9ece864f.png"}},e={};function r(a){var n=e[a];if(void 0!==n)return n.exports;var o=e[a]={exports:{}};return t[a].call(o.exports,o,o.exports,r),o.exports}r.m=t,function(){var t=[];r.O=function(e,a,n,o){if(!a){var s=1/0;for(u=0;u<t.length;u++){a=t[u][0],n=t[u][1],o=t[u][2];for(var i=!0,c=0;c<a.length;c++)(!1&o||s>=o)&&Object.keys(r.O).every((function(t){return r.O[t](a[c])}))?a.splice(c--,1):(i=!1,o<s&&(s=o));if(i){t.splice(u--,1);var l=n();void 0!==l&&(e=l)}}return e}o=o||0;for(var u=t.length;u>0&&t[u-1][2]>o;u--)t[u]=t[u-1];t[u]=[a,n,o]}}(),function(){r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,{a:e}),e}}(),function(){r.d=function(t,e){for(var a in e)r.o(e,a)&&!r.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){r.p="/"}(),function(){var t={143:0};r.O.j=function(e){return 0===t[e]};var e=function(e,a){var n,o,s=a[0],i=a[1],c=a[2],l=0;if(s.some((function(e){return 0!==t[e]}))){for(n in i)r.o(i,n)&&(r.m[n]=i[n]);if(c)var u=c(r)}for(e&&e(a);l<s.length;l++)o=s[l],r.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return r.O(u)},a=self["webpackChunkfront"]=self["webpackChunkfront"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=r.O(void 0,[998],(function(){return r(2993)}));a=r.O(a)})();
//# sourceMappingURL=app.b7939992.js.map